%% Building measurement matrix [H]

function H = jacobian_H(x, n_medicoes)
   H = zeros(n_medicoes, length(x)); % identity matrix
   H(1,1) = 2*(x(1)-x(3)); H(1,3) = 2*(x(3)-x(1));
   H(1,2) = 2*(x(2)-x(4)); H(1,4) = 2*(x(4)-x(2));
   
   H(2,1) = 2*(x(1)-x(5)); H(2,5) = 2*(x(5)-x(1));
   H(2,2) = 2*(x(2)-x(6)); H(2,6) = 2*(x(6)-x(2)); 
   
   H(3,1) = 2*(x(1)-x(7)); H(3,7) = 2*(x(7)-x(1));
   H(3,2) = 2*(x(2)-x(8)); H(3,8) = 2*(x(8)-x(2));
   
   H(4,15) = 1; H(5,16) = 1;
% H(1:3,1) = x(1); H(1:3,2) = x(2);
% H(1,3) = -2*x(1)+x(3); H(1,4) = -2*x(2)+x(4);
% H(2,5) = -2*x(1)+x(5); H(2,6) = -2*x(2)+x(6);
% H(3,7) = -2*x(1)+x(7); H(3,8) = -2*x(2)+x(8);
end